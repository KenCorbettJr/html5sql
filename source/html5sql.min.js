/* html5sql.js MIT v0.9.5 http://html5sql.com/ */
var html5sql=function(){function e(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")}function f(a){return"[object Array]"===Object.prototype.toString.call(a)}function g(a){return void 0===a}function i(a){return h.test(a)}function j(a){var b=0;do{if(!i(a[b].sql))return!1;b++}while(b<a.length);return!0}function k(a,b,c,e){var f=0,g=null,h=function(){a.executeSql(b[f].sql,b[f].data,j,k)},j=function(a,e){var j,k,l=[];if(d.logInfo&&console.log("Success processing: "+b[f].sql),d.putSelectResultsInArray&&i(b[f].sql))for(j=0,k=e.rows.length;k>j;j++)l[j]=e.rows.item(j);else l=null;g=b[f].success(a,e,l),f++,g&&$.isArray(g)?(b[f].data=g,g=null):g=null,b.length>f?h():c(a,e,l)},k=function(a,c){d.logErrors&&console.error("Error: "+c.message+" while processing statment "+(f+1)+": "+b[f].sql),e(c,b[f].sql)};h()}function m(a){var b;if("string"==typeof a)for(a=e(a),a=a.split(";"),b=1;b<a.length;b++){for(;a[b].split(/["]/gm).length%2===0||a[b].split(/[']/gm).length%2===0||a[b].split(/[`]/gm).length%2===0;)a.splice(b,2,a[b]+";"+a[b+1]);a[b]=e(a[b])+";",";"===a[b]&&a.splice(b,1)}for(f(a)===!1&&(a=[new l(a)]),b=0;b<a.length;b++)a[b]=new l(a[b]);return a}var a=!1,b=function(){},c=[],d={database:null,logInfo:!1,logErrors:!0,putSelectResultsInArray:!0,defaultFailureCallback:b},h=new RegExp("^select\\s","i"),l=function(a){if("string"==typeof a&&(a={sql:a}),this.sql=a.sql,this.data=a.data||c,this.success=a.success||b,"string"!=typeof this.sql||"function"!=typeof this.success||!$.isArray(this.data))throw new Error("Malformed sql object: "+this)};return d.openDatabase=function(b,c,e,f){d.database=openDatabase(b,"",c,e),a="function"==typeof d.database.readTransaction,f&&f()},d.process=function(c,e,f){if(!d.database)return d.logErrors&&console.error("Error: Database needs to be opened before sql can be processed."),!1;var h=m(c);g(e)&&(e=b),g(f)&&(f=d.defaultFailureCallback),j(h)&&a?d.database.readTransaction(function(a){k(a,h,e,f)}):d.database.transaction(function(a){k(a,h,e,f)})},d.changeVersion=function(a,c,e,f,h){if(!d.database)return d.logErrors&&console.log("Error: Database needs to be opened before sql can be processed."),!1;if(d.database.version===a){var i=m(e);g(f)&&(f=b),g(h)&&(h=d.defaultFailureCallback),d.database.changeVersion(a,c,function(a){k(a,i,f,h)})}},d}();